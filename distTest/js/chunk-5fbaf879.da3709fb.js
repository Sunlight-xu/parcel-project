(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fbaf879"],{"0120":function(e,t,a){"use strict";a("8430")},"0597":function(e,t,a){"use strict";a("1d36")},"0b15":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_container"},[a("div",{staticClass:"alarm_content"},[a("h3",[e._v("物品拿取事件")]),a("search-module",{attrs:{filtersItem:["time","area"],type:"takeTrace",areaTree:e.areaTree},on:{searchData:e.handleSearch}}),a("div",{staticClass:"table_container"},[a("common-table",{attrs:{isShowIndex:!0,tableColArray:e.tableColumn,currentPage:e.currentPage,pageSize:e.pageSize,tableData:e.tableData},scopedSlots:e._u([{key:"time",fn:function(t){return[e._v(" "+e._s(new Date(t.row.event_time).toLocaleString())+" ")]}},{key:"image",fn:function(t){return[t.row.choose_image?a("span",{staticClass:"catch_img"},[a("img",{attrs:{src:"data:image/jpg;base64,"+t.row.choose_image,alt:""}}),a("el-button",{staticStyle:{padding:"4px"},attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){return e.chooseCatchImg(t.row)}}},[e._v("重新选择")])],1):a("span",{staticClass:"catch_img"},[a("img",{attrs:{src:"/avtor.jpg",size:"small",alt:"",srcset:""}}),a("el-button",{staticStyle:{padding:"4px"},attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){return e.chooseCatchImg(t.row)}}},[e._v("选择抓拍")])],1)]}},{key:"operation",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showVideo(t.row)}}},[e._v("视频")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.tracePerson(t.row)}}},[e._v("追踪")])]}}])})],1),a("div",{staticClass:"pagintion_content"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.hanleCurrentPChange,"size-change":e.handleSizeChange}})],1)],1),a("el-dialog",{attrs:{width:"840px",visible:e.videoVisible},on:{"update:visible":function(t){e.videoVisible=t}}},[a("div",[e._v(e._s(e.currVideoCamera))]),a("div",{staticStyle:{position:"relative"}},[a("video",{attrs:{autoplay:"",width:"100%",height:"450px",muted:"",controls:"",id:"media",src:e.currentVideoUrl},domProps:{muted:!0},on:{ended:e.nextVideo}}),a("div",{staticClass:"video_list_btn"},e._l(e.videoUrl,(function(t,i){return a("span",{key:t,class:e.currentVideoIndex===i?"current_span":"",on:{click:function(t){return e.changeIndex(i)}}},[e._v(" "+e._s(i+1)+" ")])})),0)])]),a("el-dialog",{attrs:{title:"选择嫌疑人抓拍照",width:"840px",visible:e.catchVisible},on:{"update:visible":function(t){e.catchVisible=t}}},[a("div",{staticClass:"catch_video"},[a("img",{attrs:{width:"800",src:e.catchImg,alt:""}})]),a("div",{staticClass:"catch_list"},[a("span",{staticClass:"catch_list_title"},[e._v("点击抓拍照进行选择")]),a("span",{staticClass:"catch_list_imgs"},e._l(e.imageList,(function(t){return a("span",{key:t.url,class:e.currentImgIndex===t.url?"span_active":"",on:{click:function(a){return e.chooseImg(t.url)}}},[a("img",{attrs:{src:"data:image/jpg;base64,"+t.url,width:"110",height:"138",alt:""}})])})),0)]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.catchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.chooseImgConfirm}},[e._v("确 定")])],1)])],1)},r=[],n=a("b85c"),s=a("5530"),l=(a("4160"),a("d3b7"),a("159b"),a("b0c0"),a("5c96")),c=a("7f5c"),o=a("c31e"),d=a("b837"),m=a("144c"),u=a("605c"),h={data:function(){return{tableData:[],pageSize:10,currentPage:1,tableColumn:[{label:"事件时间",props:"event_time",type:"slot",slot:"time"},{label:"事件区域",props:"event_area"},{label:"抓拍相机",props:"snap_camera"},{label:"嫌疑人抓拍照",props:"",type:"slot",slot:"image"},{label:"操作",props:"operation",type:"slot",slot:"operation"}],total:0,areaTree:[],videoUrl:[],videoCameraName:[],videoVisible:!1,catchVisible:!1,imageList:[],catchImg:"",currentImgIndex:-1,currentVideoIndex:0,currentVideoUrl:"",currVideoCamera:""}},components:{SearchModule:o["a"],CommonTable:d["a"]},mounted:function(){this.getAlarmHistory(),this.getAreaTree()},methods:{hanleCurrentPChange:function(e){this.currentPage=e,this.getAlarmHistory()},handleSizeChange:function(e){this.pageSize=e,this.getAlarmHistory()},getAlarmHistory:function(e){var t=this;e&&(this.params=e),Object(c["o"])(Object(s["a"])({page:this.currentPage,page_size:this.pageSize},this.params)).then((function(e){0===e.error_no&&(t.tableData=e.data.events||[],t.total=e.data.count)}))},handleSearch:function(e){this.currentPage=1,this.pageSize=10,this.getAlarmHistory(e)},getAreaTree:function(){var e=this;Object(c["f"])().then((function(t){e.areaTree=t.data}))},getCamera:function(){Object(c["g"])()},getArea:function(e,t){var a="";return this.areaTree.forEach((function(i){i.id===e&&(a+=i.name,i.child.forEach((function(e){e.id===t&&(a+=e.name)})))})),a},getType:function(e){var t="";return u["a"].forEach((function(a){a.id===e&&(t=a.label)})),t},getHandleType:function(e){return 2===e.check_status?"未处理":1===e.check_status?"已处理":""},showVideo:function(e){var t=this;e.videos&&0!==e.videos.length?Object(c["r"])(e.videos).then((function(e){if(0===e.error_no){var a,i=[],r=[],s=Object(n["a"])(e.data);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(""!==c.video_url){c.video_url=Object(m["a"])(c.video_url),i.push(c.video_url);var o,d=c.camera_id,u=Object(n["a"])(t.cameraList);try{for(u.s();!(o=u.n()).done;){var h=o.value;if(h.id===d){d=h.airport_name,d&&""!==d||(d=h.ip);break}}}catch(p){u.e(p)}finally{u.f()}r.push(d)}}}catch(p){s.e(p)}finally{s.f()}i.length>0?(t.videoVisible=!0,t.videoUrl=i,t.videoCameraName=r,t.currentVideoIndex=0,t.currentVideoUrl="",t.videoUrl.length>t.currentVideoIndex&&(t.currentVideoUrl=t.videoUrl[t.currentVideoIndex],t.currVideoCamera=t.videoCameraName[t.currentVideoIndex])):(l["Message"].warning({message:"视频未下载"}),t.currentVideoIndex=0,t.currentVideoUrl="")}})):(l["Message"].warning({message:"没有可下载视频"}),this.currentVideoIndex=0,this.currentVideoUrl="")},getCameraIp:function(e){return e.camera_id},tracePerson:function(e){e.choose_image?this.$router.push({name:"traceDetail",params:{image:e.choose_image,time:e.event_time}}):l["Message"].error({message:"请先选择抓拍"})},chooseCatchImg:function(e){var t=this;this.currentImgIndex=-1,this.currentRow=e,this.catchImg=e.snap_draw_frame_image_url,Object(c["j"])({image_url:e.snap_draw_frame_image_url}).then((function(e){var a=[];0===e.error_no&&e.data.images.forEach((function(e,t){a.push({id:t,url:e.image})})),t.imageList=a})),this.catchVisible=!0},chooseImg:function(e){this.currentImgIndex=e},chooseImgConfirm:function(){var e=this;Object(c["x"])({id:this.currentRow.id,image:this.currentImgIndex}).then((function(t){0===t.error_no&&(e.getAlarmHistory(),e.catchVisible=!1)}))},changeIndex:function(e){this.currentVideoIndex=e,this.currentVideoUrl="",this.currVideoCamera="",this.videoUrl.length>this.currentVideoIndex&&(this.currentVideoUrl=this.videoUrl[this.currentVideoIndex],this.currVideoCamera=this.videoCameraName[this.currentVideoIndex])},nextVideo:function(){if(1===this.videoUrl.length)return document.getElementById("media").currentTime=0,void document.getElementById("media").play();this.videoUrl.length-1>this.currentVideoIndex?this.currentVideoIndex++:this.currentVideoIndex=0,this.currentVideoUrl="",this.currVideoCamera="",this.videoUrl.length>this.currentVideoIndex&&(this.currentVideoUrl=this.videoUrl[this.currentVideoIndex],this.currVideoCamera=this.videoCameraName[this.currentVideoIndex])}}},p=h,g=(a("0120"),a("2877")),v=Object(g["a"])(p,i,r,!1,null,"61778ff2",null);t["default"]=v.exports},"144c":function(e,t,a){"use strict";function i(e){return e&&""!==e&&"1"!==sessionStorage.getItem("showMenu")?"/znjc".concat(e):e}a.d(t,"a",(function(){return i}))},"1d36":function(e,t,a){},"605c":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var i=[{id:5001,label:"客流密度"},{id:5002,label:"物品遗留"},{id:5003,label:"物品拿取"},{id:5004,label:"人员倒地"},{id:5005,label:"人员滞留"},{id:5006,label:"人员徘徊"},{id:5007,label:"人员聚集"},{id:5008,label:"剧烈运动/打斗"},{id:5009,label:"排队人数"},{id:5010,label:"客流量报警"}]},8430:function(e,t,a){},"87a8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-slider"},[a("div",{staticClass:"my-slider__tooltip",style:e.style},[a("div",{staticClass:"my-slider__tooltip-wrapper",attrs:{size:"mini"}},[e._v(" "+e._s(e.slider)+" ")])]),a("el-slider",{attrs:{"show-tooltip":!1,min:e.min,max:e.max},on:{input:e.input},model:{value:e.slider,callback:function(t){e.slider=t},expression:"slider"}})],1)},r=[],n=(a("a9e3"),{name:"MySlider",model:{prop:"value",event:"change"},props:{value:{type:Number,default:80},min:{type:Number,default:30},max:{type:Number,default:100}},data:function(){return{slider:this.value}},watch:{value:function(e){this.slider=e}},computed:{style:function(){var e=this.max-this.min,t=this.slider-this.min,a=t/e*100;return{paddingLeft:"".concat(a,"%")}}},methods:{input:function(e){this.$emit("change",e)}}}),s=n,l=(a("b493"),a("2877")),c=Object(l["a"])(s,i,r,!1,null,"3c5963fd",null);t["a"]=c.exports},b493:function(e,t,a){"use strict";a("e8aa")},c31e:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"input_search"},[e.filters("time")?a("div",{staticClass:"search_item"},[a("h4",[e._v(" 抓拍时间 ")]),a("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.datetimerange,callback:function(t){e.datetimerange=t},expression:"datetimerange"}})],1):e._e(),e.filters("area")?a("div",{staticClass:"search_item"},[a("h4",[e._v("区域")]),a("el-cascader",{attrs:{placeholder:"所有二级区域","collapse-tags":!0,"show-all-levels":!1,options:e.areaOptions,props:{multiple:!0},size:"small",clearable:!0},model:{value:e.area,callback:function(t){e.area=t},expression:"area"}})],1):e._e(),e.filters("camera")?a("div",{staticClass:"search_item"},[a("h4",[e._v("抓拍相机")]),a("el-select",{attrs:{multiple:"","collapse-tags":"",size:"small"},model:{value:e.camera,callback:function(t){e.camera=t},expression:"camera"}},e._l(e.camerasData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.ip,value:e.id}})})),1)],1):e._e(),e.filters("alarmType")?a("div",{staticClass:"search_item"},[a("h4",[e._v("报警类型")]),a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.alarmType,callback:function(t){e.alarmType=t},expression:"alarmType"}},e._l(e.alarmTypeOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1):e._e(),e.filters("alarmLevel")?a("div",{staticClass:"search_item"},[a("h4",[e._v("报警级别")]),a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.alarmLevel,callback:function(t){e.alarmLevel=t},expression:"alarmLevel"}},e._l(e.alarmLevelOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.filters("status")?a("div",{staticClass:"search_item"},[a("h4",[e._v("处置状态")]),a("el-select",{attrs:{size:"small"},model:{value:e.dealType,callback:function(t){e.dealType=t},expression:"dealType"}},e._l(e.dealTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.filters("image")?a("div",{staticClass:"search_item"},[a("h4",[e._v("照片")]),a("div",{staticStyle:{height:"110px","text-align":"center"}},[a("img",{staticClass:"image_class",attrs:{src:"data:image/jpg;base64,"+e.image,alt:""}})])]):e._e(),e.filters("similar")?a("div",{staticClass:"search_item"},[a("h4",[e._v("相似度")]),a("my-slider",{model:{value:e.similarity,callback:function(t){e.similarity=t},expression:"similarity"}})],1):e._e(),e.filters("deviceName")?a("div",{staticClass:"search_item"},[a("h4",[e._v("设备名称")]),a("el-input",{attrs:{size:"small",placeholder:"请输入设备名称"},model:{value:e.deviceName,callback:function(t){e.deviceName=t},expression:"deviceName"}})],1):e._e(),e.filters("ip")?a("div",{staticClass:"search_item"},[a("h4",[e._v("IP地址")]),a("el-input",{attrs:{size:"small",placeholder:"请输入IP地址"},model:{value:e.ip,callback:function(t){e.ip=t},expression:"ip"}})],1):e._e(),e.filters("channel")?a("div",{staticClass:"search_item"},[a("h4",[e._v("channel号")]),a("el-input",{attrs:{size:"small",placeholder:"请输入channel号"},model:{value:e.channel,callback:function(t){e.channel=t},expression:"channel"}})],1):e._e(),a("div",{staticClass:"button_styles"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submit}},[e._v("查询")]),a("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)])},r=[],n=a("b85c"),s=(a("0d03"),a("b0c0"),a("c975"),a("4160"),a("d3b7"),a("159b"),a("87a8")),l=[{id:5002,label:"物品遗留"},{id:5003,label:"物品拿取"},{id:5006,label:"人员徘徊"},{id:5005,label:"人员滞留"}],c=[{id:5001,label:"客流密度"},{id:5004,label:"人员倒地"},{id:5007,label:"人员聚集"},{id:5008,label:"剧烈运动/打斗"},{id:5009,label:"排队时长"},{id:5010,label:"客流量报警"}],o={props:{filtersItem:{type:Array,default:function(){return[]}},areaTree:{type:Array,default:function(){return[]}},camerasData:{type:Array,default:function(){return[]}},type:{type:String},image:{type:String,default:""},time:{default:""}},data:function(){return{startTime:new Date((new Date).toLocaleDateString()),endTime:new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1),datetimerange:[new Date((new Date).toLocaleDateString()),new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)],areaOptions:[],area:[],camera:[],alarmType:"",dealType:"",dealTypeOptions:[{value:1,label:"已处理"},{value:2,label:"未处理"}],alarmLevel:"",alarmLevelOptions:[{value:1,label:"一级"}],alarmTypeOptions:[],similarity:70,deviceName:"",ip:"",channel:""}},watch:{areaTree:{handler:function(e){this.areaOptions=[];var t,a=Object(n["a"])(e);try{for(a.s();!(t=a.n()).done;){var i=t.value,r={label:i.name,value:i.id};if(i.child&&i.child.length>0){r.children=[];var s,l=Object(n["a"])(i.child);try{for(l.s();!(s=l.n()).done;){var c,o=s.value,d=[],m=Object(n["a"])(o.child);try{for(m.s();!(c=m.n()).done;){var u=c.value;d.push({label:u.name,value:u.id})}}catch(h){m.e(h)}finally{m.f()}r.children.push({label:o.name,value:o.id,children:d.length>0?d:void 0})}}catch(h){l.e(h)}finally{l.f()}}this.areaOptions.push(r)}}catch(h){a.e(h)}finally{a.f()}},immediate:!0},time:{handler:function(e){e&&(this.datetimerange=[new Date(new Date(e).toLocaleDateString()),new Date(new Date(new Date(e).toLocaleDateString()).getTime()+864e5-1)],this.startTime=new Date(new Date(e).toLocaleDateString()),this.endTime=new Date(new Date(new Date(e).toLocaleDateString()).getTime()+864e5-1))},immediate:!0}},components:{MySlider:s["a"]},created:function(){"alarmHistory"===this.type?this.alarmTypeOptions=c:this.alarmTypeOptions=l},methods:{filters:function(e){return!!this.filtersItem&&-1!==this.filtersItem.indexOf(e)},submit:function(){var e={},t=[];this.area.length>0&&this.area.forEach((function(e){t.push(e[e.length-1])})),"areaManage"===this.type&&this.area.length>0&&(e={area_ids:t}),"alarmConfig"===this.type&&this.area.length>0&&(e={area_ids:t}),"alarmHistory"===this.type&&(this.area.length>0&&(e.area_ids=t),this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime()),e.type=0,e.camera_ids=this.camera,e.check_status=this.dealType||void 0,e.alarm_source_types=this.alarmType?[this.alarmType]:void 0),"eventSearch"===this.type&&(this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime()),this.area.length>0&&(e.area_ids=t),e.camera_ids=this.camera,e.alarm_source_types=this.alarmType?[this.alarmType]:void 0),"trackDetail"===this.type&&(this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime()),e.score=this.similarity),"takeTrace"===this.type&&(this.area.length>0&&(e.area_ids=t),this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime())),"deviceManage"===this.type&&(e.name=this.deviceName,e.ip=this.ip,e.channel=this.channel),"resourceManage"===this.type&&(this.area.length>0&&(e.area_ids=t),e.name=this.deviceName,e.ip=this.ip,e.channel=this.channel),this.$emit("searchData",e)},reset:function(){this.area=[],this.alarmType="",this.alarmLevel="",this.dealType="",this.camera=[],this.deviceName="",this.channel="",this.ip="",this.datetimerange=[new Date((new Date).toLocaleDateString()),new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)],this.startTime=new Date((new Date).toLocaleDateString()),this.endTime=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)}}},d=o,m=(a("0597"),a("2877")),u=Object(m["a"])(d,i,r,!1,null,"3fd3d4d3",null);t["a"]=u.exports},e8aa:function(e,t,a){}}]);