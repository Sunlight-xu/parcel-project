(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9bf7ae20"],{"02c2":function(t,e,a){},"0fb3":function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return c}));var i=a("8761"),s=function(){return i["a"].get("/admin/disinfection/cameras")},n=function(t){return i["a"].post("/admin/alarms",t,{},!1)},c=function(t,e){return i["a"].patch("/admin/disinfection/check_alarm/".concat(e),t)}},"2cc9":function(t,e,a){"use strict";a("02c2")},3457:function(t,e,a){"use strict";a("d300")},"431b":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.disabled?"confirm_button disabled":"confirm_button",on:{click:t.activeBtn}},[a("span",[t._v(t._s(t.context))])])},s=[],n={props:["context","disabled"],data:function(){return{}},methods:{activeBtn:function(){this.disabled||this.$emit("onClick")}}},c=n,l=(a("2cc9"),a("2877")),o=Object(l["a"])(c,i,s,!1,null,"18187af3",null);e["a"]=o.exports},8572:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAYCAYAAAAPtVbGAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGaADAAQAAAABAAAAGAAAAABlk77uAAACjklEQVRIDbVWzWsTQRR/b5JN/AI9+EWRFmkjicGD4KGt1ZpWiKaCLfXkX6B/QcX2KJaexf/AixRplSYXaRZFqODFg9m0aDV4CLZaL4LabHaeb1Z22TSZovmYy76Z95vfb96bebODsEszTQr/kmsXAZ1xAhwggi4AOoyIWwRQBqKVEMLiHjz9IpXCqo4KdY5svjjJJPcJ6JQO448jfACCu9dGk/P+WMCoEzHNzQM/6dsjIroewP2TiYBLB6Pi5tBQ/EdwQo1I7uX7I2Tby7z6M0HQf9mIBSMaGUmf79v05gnPKBQoIm37SUsCiowoWd2uLCg+j9sXKW0U7zHigudo5cupHixtWLMeh5uu7LLVwwNrHEXUc7ThWzHCoXh6OP7JjYQQptosoNYYsR3njjLCHJrImdYEn/uGjUP9zqdmRiI6OwHIDiA5w/VzYqdP9ZFgnPlvY9ZcPUfSedMI5AIR3o6NJM/q/Et56zlv9mWdnxfSLxBkrw7QnnHRK/5eFe2ha8RCJLt44zmgDjchkMqd1EAUZQEYWu+kCIBcR3WEs3lLRXNMI/bZEOE0CqfuCDuOEJLkvO4q4l/C10wqcTzMhuSKX2DgLY1Ity2rRZCNvHW6NSCuvUXF71Y8b8wc19V2DaLFDh8nW5Axp2hckaupRAkFPmiRt2Y6ET7MjMbc/XZFlLfnaHyaL4lXNcgmO5yi16LbcO8tReGLJJNYMaLRSS6bd01yu9O46IqAeycysZiffl9EIdTf7FBEDHJEz5oSQszh/kj/WOrkl+B8bbXnzNUbkpxZfiD0BSdo7I8hgdNXLiUec6rqLnStiCJTT6LfZA07fGVzGgcY7D6J2LXFG1vmE7TCCX+6jxLmbk+iP/hs5G9sNegKAAAAAElFTkSuQmCC"},"8b6b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"main_container"},[a("div",{staticClass:"page_content"},[a("div",{staticClass:"area_select border_radius cameras"},[a("el-input",{attrs:{placeholder:"搜索",clearable:""},model:{value:t.searchletter,callback:function(e){t.searchletter=e},expression:"searchletter"}}),a("el-collapse",t._l(t.areaCameraData,(function(e){return a("el-collapse-item",{key:e.label,attrs:{name:e.label},scopedSlots:t._u([{key:"title",fn:function(){return[a("div",{staticClass:"cameras_title"},[t._v(" "+t._s(e.label)+" ")])]},proxy:!0}],null,!0)},t._l(e.children,(function(e){return a("div",{key:e.id,staticClass:"cameras_item",on:{click:function(a){return t.chooseVideo(e.id)}}},[a("span",{staticClass:"cameras_item_context broder-radius",style:t.getItemStyle(e.id)},[t._v(" "+t._s(e.location)+" ")])])})),0)})),1)],1),a("div",{staticClass:"monitor_content border_radius"},[t._m(0),a("div",{staticClass:"video_func"},[a("div",{staticClass:"left_btn"},[a("span",{on:{click:t.catchImg}},[a("svg-icon",{staticClass:"icon_style",attrs:{"icon-class":"jietu"}}),a("i",[t._v("抓图")])],1),t.fullScreen?a("span",{on:{click:t.chanelFull}},[a("svg-icon",{staticClass:"icon_style",attrs:{"icon-class":"closefullscreen"}}),a("i",[t._v("恢复")])],1):a("span",{on:{click:t.fullVideo}},[a("svg-icon",{staticClass:"icon_style",attrs:{"icon-class":"quanping"}}),a("i",[t._v("全屏")])],1),a("span",{on:{click:t.closeVideo}},[a("svg-icon",{staticClass:"icon_style",attrs:{"icon-class":"guanbi"}}),a("i",[t._v("关闭")])],1)]),a("div",{staticClass:"right_btn"},[a("i",{directives:[{name:"show",rawName:"v-show",value:"关闭轮询"===t.pollText,expression:"pollText === '关闭轮询'"}],staticClass:"right_btn_tip"},[t._v("轮询中...")]),a("span",{on:{click:t.makePollPlan}},["关闭轮询"!==t.pollText?a("svg-icon",{staticClass:"icon_style",attrs:{"icon-class":"lunxun"}}):a("svg-icon",{staticClass:"icon_style",attrs:{"icon-class":"closePoll"}}),a("i",[t._v(t._s(t.pollText))])],1)])])]),a("div",{staticClass:"today_alarm border_radius"},[a("div",{staticClass:"today_alarm_title"},[a("span",{staticClass:"today_alarm_title_h"},[t._v("今日预警")]),a("span",{staticClass:"today_alarm_title_m",on:{click:t.searchMore}},[t._v("更多")])]),a("div",{staticClass:"today_alarm_content"},t._l(t.alarmList,(function(e){return a("div",{key:e.id,staticClass:"today_alarm_content_item"},[a("div",{staticClass:"today_alarm_content_item_header"},[t._v(t._s(e.disinfection_alarm_type_desc))]),a("div",{staticClass:"today_alarm_content_item_content"},[a("img",{attrs:{width:"96px",height:"118px",src:e.detected_image_url}}),a("div",{staticClass:"detail"},[a("span",[a("i",{staticClass:"detail_key"},[t._v("报警ID")]),a("i",{staticClass:"detail_value"},[t._v(t._s(e.id))])]),a("span",[a("i",{staticClass:"detail_key"},[t._v("报警时间")]),a("i",{staticClass:"detail_value"},[t._v(t._s(t.getTimeFormat(e.alarm_time)))])]),a("span",[a("i",{staticClass:"detail_key"},[t._v("报警相机")]),a("i",{staticClass:"detail_value"},[t._v(t._s(t.getCameraName(e.camera_id)))])]),a("span",[a("i",{staticClass:"detail_key"},[t._v("消杀通道")]),a("i",{staticClass:"detail_value"},[t._v(t._s(e.disinfection_channel_name))])]),a("span",[a("i",{staticClass:"detail_key"},[t._v("报警内容")]),a("i",{staticClass:"detail_value"},[t._v(t._s(e.disinfection_alarm_desc))])])])]),a("div",{staticClass:"today_alarm_content_item_button"},[a("div",[a("span",{staticClass:"text"},[t._v("复核视频")]),a("img",{attrs:{src:t.alarmPlay,alt:""},on:{click:function(a){return t.playAlarmVideo(e.video_url)}}})]),a("div",{staticClass:"today_alarm_content_item_button_buttons"},[a("chanelButton",{attrs:{context:"撤销",disabeld:!1},on:{onClick:function(a){return t.alarmChanel(e.id)}}}),a("confirmButton",{attrs:{context:"确认",disabled:!1},on:{onClick:function(a){return t.alarmConfrim(e.id)}}})],1)])])})),0)])]),a("el-dialog",{attrs:{width:"620",visible:t.videoVisible},on:{"update:visible":function(e){t.videoVisible=e}}},[a("video",{attrs:{width:"600px",autoplay:"",src:t.videoUrl}})]),a("el-dialog",{attrs:{title:"轮询计划","show-close":!1,"destroy-on-close":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.turnPlanVisible,width:"500px"},on:{"update:visible":function(e){t.turnPlanVisible=e}}},[a("el-tree",{attrs:{"node-key":"id","show-checkbox":"","default-checked-keys":t.checkedNodes,data:t.treeData},on:{check:t.handlePollNode}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.chanelPollPlan}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.startPoll}},[t._v("确 定")])],1)],1)],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"videos_screen"},[a("div",{staticClass:"vide_item_full"},[a("video",{attrs:{width:"100%",height:"100%",autoplay:"",src:"http://172.16.25.5:31788/2022/1/9/ch01001_1641714705000_2pts.mp4"}})])])}],n=a("1da1"),c=(a("96cf"),a("4de4"),a("d3b7"),a("c975"),a("fb6a"),a("4795"),a("4160"),a("159b"),a("99af"),a("45fc"),a("5c96")),l=a("510e"),o=a("8572"),r=a.n(o),d=a("0fb3"),u=a("7cf8"),h=(a("6b28"),a("431b")),_=a("bcd4"),m={data:function(){return{activeName:[],searchletter:"",fullScreen:!1,videos:[],selectVideo:"",catchId:"",pollText:"轮询",alarmPlay:r.a,areaCameraData:[],chooseVideoId:"",alarmList:[],videoVisible:!1,videoUrl:"",turnPlanVisible:!1,checkedNodes:[],treeData:[]}},computed:{},watch:{searchletter:{handler:function(t){var e=this.camerasData.filter((function(e){return-1!==e.location.indexOf(t)}));this.areaCameraData=Object(l["b"])(e,"disinfection_area_name")}}},components:{ConfirmButton:h["a"],ChanelButton:_["a"]},created:function(){var t=this;Object(d["c"])().then((function(e){if(0===e.error_no){var a=e.data.cameras;t.camerasData=a,t.videos=a.slice(0,4),t.areaCameraData=Object(l["b"])(a,"disinfection_area_name")}})),this.getAlarmList(),this.timer=setInterval((function(){t.getAlarmList()}),1e3)},beforeDestroy:function(){clearInterval(this.pollTimer),clearInterval(this.timer)},methods:{searchMore:function(){this.$router.push({name:"historyAlarm"})},chooseVideo:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.chooseVideoId=t,a.next=3,Object(u["d"])({stream_id:t,user_id:"user1"});case 3:i=a.sent,""!==e.selectVideo&&(e.$set(e.videos,e.selectVideo,{id:t,video_url:i.data}),e.initSelect());case 5:case"end":return a.stop()}}),a)})))()},getItemStyle:function(t){return this.chooseVideoId===t?{background:"var(--color-bg-3)",color:"#fff"}:{}},selectItem:function(t){this.selectVideo=t,clearInterval(this.pollTimer),this.pollText="轮询"},isSelect:function(t){return this.selectVideo===t?{border:"2px solid #FF8E0A",borderRadius:"5px"}:{}},catchImg:function(){""===this.selectVideo&&c["Message"].error({message:"需要选中通道进行相应操作"}),this.catchId=this.selectVideo},fullVideo:function(){""===this.selectVideo&&c["Message"].error({message:"需要选中通道进行相应操作"}),""!==this.selectVideo&&(this.fullScreen=!0)},chanelFull:function(){this.fullScreen=!1,this.initSelect()},initSelect:function(){this.catchId="",this.fullVideo||(this.selectVideo="")},closeVideo:function(){this.fullScreen=!1,""!==this.selectVideo?this.$set(this.videos,this.selectVideo,{}):c["Message"].error({message:"需要选中通道进行相应操作"}),this.initSelect()},makePollPlan:function(){if("关闭轮询"===this.pollText)return clearInterval(this.pollTimer),void(this.pollText="轮询");this.turnPlanVisible?this.turnPlanVisible=!1:(this.turnPlanVisible=!0,this.treeData=this.areaCameraData)},chanelPollPlan:function(){this.turnPlanVisible=!1,this.checkedNodes=[]},startPoll:function(){var t=this;if(this.turnPlanVisible=!1,this.fullScreen&&this.chanelFull(),clearInterval(this.pollTimer),this.pollText="轮询",0!==this.checkedNodes.length){Object(c["Message"])({type:"success",message:"开始轮询"}),this.pollText="轮询中";var e=0,a=0;console.log(this.checkedNodes),Object(u["d"])({stream_id:this.checkedNodes[e],user_id:"user1"}).then((function(i){0===i.error_no&&t.videos[a].id!==t.checkedNodes[e]&&t.$set(t.videos,a,{id:t.checkedNodes[e],video_url:i.data})})),this.pollTimer=setInterval((function(){e>=t.checkedNodes.length-1?e=0:e++,a>=3?a=0:a++,e<=t.checkedNodes.length-1&&Object(u["d"])({stream_id:t.checkedNodes[e],user_id:"user1"}).then((function(i){0===i.error_no?t.videos[a].id!==t.checkedNodes[e]&&t.$set(t.videos,a,{id:t.checkedNodes[e],video_url:i.data}):(clearInterval(t.pollTimer),t.pollText="轮询",t.setShowVideo())}))}),5e3)}else Object(c["Message"])({type:"error",message:"未选择轮询相机"})},handlePollNode:function(t,e){var a=this;this.checkedNodes=[],e.checkedNodes.forEach((function(t){t.id&&a.checkedNodes.push(t.id)}))},getAlarmList:function(){var t=this;Object(d["b"])({types:[1],page_size:10,check_status:2,start_time:16416576e5,end_time:1641743999e3}).then((function(e){0===e.error_no&&(t.alarmList=e.data.alarms)}))},getTimeFormat:function(t){var e=l["a"].getTime(t/1e3);return"".concat(e.nowYear,"/").concat(e.nowMonth,"/").concat(e.nowDate," ").concat(e.nowHour,":").concat(e.nowMin,":").concat(e.nowSec)},getCameraName:function(t){var e="";return this.camerasData.some((function(a){return a.id===t&&(e=a.location,!0)})),e},alarmChanel:function(t){var e=this;Object(d["a"])({alarm_type:2,remark:""},t).then((function(t){0===t.error_no&&(c["Message"].success("成功"),e.getAlarmList())}))},alarmConfrim:function(t){var e=this;Object(d["a"])({alarm_type:1,remark:""},t).then((function(t){0===t.error_no&&(c["Message"].success("成功"),e.getAlarmList())}))},playAlarmVideo:function(t){t&&(this.videoVisible=!0,this.videoUrl=t)}}},f=m,v=(a("3457"),a("2877")),A=Object(v["a"])(f,i,s,!1,null,"54543fb2",null);e["default"]=A.exports},bcd4:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.disabled?"confirm_button disabled":"confirm_button",on:{click:t.activeBtn}},[a("span",[t._v(t._s(t.context))])])},s=[],n={props:["context","disabled"],data:function(){return{}},methods:{activeBtn:function(){this.$emit("onClick")}}},c=n,l=(a("f461"),a("2877")),o=Object(l["a"])(c,i,s,!1,null,"6ed08c84",null);e["a"]=o.exports},d300:function(t,e,a){},d4e3:function(t,e,a){},f461:function(t,e,a){"use strict";a("d4e3")}}]);