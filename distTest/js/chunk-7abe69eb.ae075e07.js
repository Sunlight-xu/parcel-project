(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7abe69eb"],{"0597":function(e,t,a){"use strict";a("1d36")},"1d36":function(e,t,a){},"348b":function(e,t,a){"use strict";a("e370")},"3aff":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"page_container"},[a("div",{staticClass:"config_container border_radius"},[a("div",{},[a("el-radio-group",{attrs:{size:"small"},on:{change:e.changeTable},model:{value:e.checkboxGroup,callback:function(t){e.checkboxGroup=t},expression:"checkboxGroup"}},e._l(e.AlarmItems,(function(t){return a("el-radio-button",{key:t.id,attrs:{label:t.type}},[e._v(e._s(t.label))])})),1)],1),a("search-module",{staticClass:"search-module",attrs:{type:"alarmConfig",areaTree:e.areaTree,filtersItem:["area"]},on:{searchData:e.handleSearch}}),a("div",{staticClass:"table_container"},[a("common-table",{attrs:{isShowIndex:!0,tableData:e.tableData,tableColArray:e.tableColumn},scopedSlots:e._u([{key:"time",fn:function(t){return[e._v(" "+e._s(new Date(t.row.updated_at).toLocaleString())+" ")]}},{key:"handle",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.setConfig(t.row)}}},[e._v("设置")])]}}])})],1),a("div",{staticClass:"pagintion_content"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentPChange,"size-change":e.handleSizeChange}})],1),a("el-dialog",{attrs:{title:"设置",width:"500px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[5001===e.checkboxGroup?a("div",[a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("一级报警阈值")]),a("span",[a("el-input",{model:{value:e.oneLevel,callback:function(t){e.oneLevel=t},expression:"oneLevel"}})],1)]),a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("二级报警阈值")]),a("span",[a("el-input",{model:{value:e.twoLevel,callback:function(t){e.twoLevel=t},expression:"twoLevel"}})],1)]),a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("三级报警阈值")]),a("span",[a("el-input",{model:{value:e.threeLevel,callback:function(t){e.threeLevel=t},expression:"threeLevel"}})],1)])]):-1!==[5002,5004,5005,5009].indexOf(e.checkboxGroup)?a("div",[a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("报警行为持续时长")]),a("span",[a("el-input",{model:{value:e.oneValue,callback:function(t){e.oneValue=t},expression:"oneValue"}})],1)])]):5007===e.checkboxGroup?a("div",[a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("报警配置人数")]),a("span",[a("el-input",{model:{value:e.oneValue,callback:function(t){e.oneValue=t},expression:"oneValue"}})],1)])]):-1!==[5006].indexOf(e.checkboxGroup)?a("div",[a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("报警行为持续时长")]),a("span",[a("el-input",{model:{value:e.oneValue,callback:function(t){e.oneValue=t},expression:"oneValue"}})],1)]),a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px",width:"112px","line-height":"40px"}},[e._v("报警行为次数")]),a("span",[a("el-input",{model:{value:e.secValue,callback:function(t){e.secValue=t},expression:"secValue"}})],1)])]):5010===e.checkboxGroup?a("div",[a("span",{staticStyle:{display:"flex","justify-content":"center","margin-bottom":"8px"}},[a("span",{staticStyle:{"margin-right":"8px","line-height":"40px"}},[e._v("报警通行速度")]),a("span",[a("el-input",{model:{value:e.oneValue,callback:function(t){e.oneValue=t},expression:"oneValue"}})],1)])]):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.setAlarmConfig}},[e._v("确 定")])],1)])],1)])},i=[],s=a("5530"),n=(a("7db0"),a("d3b7"),a("5c96")),r=a("7f5c"),o=a("c31e"),c=a("b837"),p={density:[{label:"区域",props:"area_name"},{label:"一级报警阈值",props:"alarm_level_1"},{label:"二级报警阈值",props:"alarm_level_2"},{label:"三级报警阈值",props:"alarm_level_3"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],goods:[{label:"区域",props:"area_name"},{label:"物品遗留时长(分钟)",props:"preference_length"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],collapse:[{label:"区域",props:"area_name"},{label:"人员倒地时长(分钟)",props:"preference_length"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],stay:[{label:"区域",props:"area_name"},{label:"人员持续滞留时长(分钟)",props:"preference_length"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],hover:[{label:"区域",props:"area_name"},{label:"徘徊时长(分钟)",props:"preference_length"},{label:"徘徊次数",props:"preference_count"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],together:[{label:"区域",props:"area_name"},{label:"聚集人数",props:"preference_num"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],queue:[{label:"区域",props:"area_name"},{label:"排队时长(分钟)",props:"preference_length"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}],flow:[{label:"区域",props:"area_name"},{label:"通行速度(人/分钟)",props:"preference_traffic_speed"},{label:"更新时间",props:"updated_at",type:"slot",slot:"time"},{label:"操作",props:"",type:"slot",slot:"handle"}]},h={data:function(){return{tableData:[],tableColumn:[],oneLevel:"",twoLevel:"",threeLevel:"",oneValue:"",secValue:"",currentPage:1,pageSize:10,total:0,dialogVisible:!1,checkboxGroup:5001,areaTree:[],AlarmItems:[{id:"density",type:5001,label:"客流密度"},{id:"goods",type:5002,label:"物品遗留"},{id:"collapse",type:5004,label:"人员倒地"},{id:"stay",type:5005,label:"人员滞留"},{id:"hover",type:5006,label:"人员徘徊"},{id:"together",type:5007,label:"人员聚集"},{id:"queue",type:5009,label:"排队预警"},{id:"flow",type:5010,label:"客流量报警"}]}},components:{SearchModule:o["a"],CommonTable:c["a"]},mounted:function(){this.tableColumn=p.density,this.getAlarmConfig(),this.getAreaTree()},methods:{changeTable:function(e){var t=this.AlarmItems.find((function(t){return t.type===e}));this.tableColumn=p[t.id],this.getAlarmConfig()},getAlarmConfig:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r["c"])(Object(s["a"])({page:this.currentPage,page_size:this.pageSize,preference_type:this.checkboxGroup},t)).then((function(t){0===t.error_no&&(e.total=t.data.count,e.tableData=t.data.alarm_preferences)}))},handleSearch:function(e){this.currentPage=1,this.pageSize=10,this.getAlarmConfig(e)},handleCurrentPChange:function(e){this.currentPage=e,this.getAlarmConfig()},handleSizeChange:function(e){this.pageSize=e,this.getAlarmConfig()},setConfig:function(e){this.dialogVisible=!0,this.setRow=e,5001===this.checkboxGroup?(this.oneLevel=e.alarm_level_1,this.twoLevel=e.alarm_level_2,this.threeLevel=e.alarm_level_3):5002===this.checkboxGroup||5004===this.checkboxGroup||5005===this.checkboxGroup||5009===this.checkboxGroup?this.oneValue=e.preference_length:5006===this.checkboxGroup?(this.secValue=e.preference_count,this.oneValue=e.preference_length):5007===this.checkboxGroup?this.oneValue=e.preference_num:5010===this.checkboxGroup&&(this.oneValue=e.preference_traffic_speed)},getAreaTree:function(){var e=this;Object(r["f"])().then((function(t){e.areaTree=t.data}))},setAlarmConfig:function(){var e=this,t={id:this.setRow.id};5001===this.checkboxGroup?(t.threshold_1_level=+this.oneLevel,t.threshold_2_level=+this.twoLevel,t.threshold_3_level=+this.threeLevel):5002===this.checkboxGroup||5004===this.checkboxGroup||5005===this.checkboxGroup||5009===this.checkboxGroup?t.preference_length=+this.oneValue:5006===this.checkboxGroup?(t.preference_count=+this.secValue,t.preference_length=+this.oneValue):5007===this.checkboxGroup?t.preference_num=+this.oneValue:5010===this.checkboxGroup&&(t.preference_traffic_speed=+this.oneValue),Object(r["v"])(t).then((function(t){0===t.error_no&&(e.dialogVisible=!1,n["Message"].success("设置成功"),e.oneLevel="",e.twoLevel="",e.threeLevel="",e.oneLevel="",e.secValue="",e.getAlarmConfig())}))}}},u=h,d=(a("348b"),a("2877")),m=Object(d["a"])(u,l,i,!1,null,"e006cde8",null);t["default"]=m.exports},"7db0":function(e,t,a){"use strict";var l=a("23e7"),i=a("b727").find,s=a("44d2"),n="find",r=!0;n in[]&&Array(1)[n]((function(){r=!1})),l({target:"Array",proto:!0,forced:r},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(n)},"87a8":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-slider"},[a("div",{staticClass:"my-slider__tooltip",style:e.style},[a("div",{staticClass:"my-slider__tooltip-wrapper",attrs:{size:"mini"}},[e._v(" "+e._s(e.slider)+" ")])]),a("el-slider",{attrs:{"show-tooltip":!1,min:e.min,max:e.max},on:{input:e.input},model:{value:e.slider,callback:function(t){e.slider=t},expression:"slider"}})],1)},i=[],s=(a("a9e3"),{name:"MySlider",model:{prop:"value",event:"change"},props:{value:{type:Number,default:80},min:{type:Number,default:30},max:{type:Number,default:100}},data:function(){return{slider:this.value}},watch:{value:function(e){this.slider=e}},computed:{style:function(){var e=this.max-this.min,t=this.slider-this.min,a=t/e*100;return{paddingLeft:"".concat(a,"%")}}},methods:{input:function(e){this.$emit("change",e)}}}),n=s,r=(a("b493"),a("2877")),o=Object(r["a"])(n,l,i,!1,null,"3c5963fd",null);t["a"]=o.exports},b493:function(e,t,a){"use strict";a("e8aa")},c31e:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"input_search"},[e.filters("time")?a("div",{staticClass:"search_item"},[a("h4",[e._v(" 抓拍时间 ")]),a("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.datetimerange,callback:function(t){e.datetimerange=t},expression:"datetimerange"}})],1):e._e(),e.filters("area")?a("div",{staticClass:"search_item"},[a("h4",[e._v("区域")]),a("el-cascader",{attrs:{placeholder:"所有二级区域","collapse-tags":!0,"show-all-levels":!1,options:e.areaOptions,props:{multiple:!0},size:"small",clearable:!0},model:{value:e.area,callback:function(t){e.area=t},expression:"area"}})],1):e._e(),e.filters("camera")?a("div",{staticClass:"search_item"},[a("h4",[e._v("抓拍相机")]),a("el-select",{attrs:{multiple:"","collapse-tags":"",size:"small"},model:{value:e.camera,callback:function(t){e.camera=t},expression:"camera"}},e._l(e.camerasData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.ip,value:e.id}})})),1)],1):e._e(),e.filters("alarmType")?a("div",{staticClass:"search_item"},[a("h4",[e._v("报警类型")]),a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.alarmType,callback:function(t){e.alarmType=t},expression:"alarmType"}},e._l(e.alarmTypeOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1):e._e(),e.filters("alarmLevel")?a("div",{staticClass:"search_item"},[a("h4",[e._v("报警级别")]),a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.alarmLevel,callback:function(t){e.alarmLevel=t},expression:"alarmLevel"}},e._l(e.alarmLevelOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.filters("status")?a("div",{staticClass:"search_item"},[a("h4",[e._v("处置状态")]),a("el-select",{attrs:{size:"small"},model:{value:e.dealType,callback:function(t){e.dealType=t},expression:"dealType"}},e._l(e.dealTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.filters("image")?a("div",{staticClass:"search_item"},[a("h4",[e._v("照片")]),a("div",{staticStyle:{height:"110px","text-align":"center"}},[a("img",{staticClass:"image_class",attrs:{src:"data:image/jpg;base64,"+e.image,alt:""}})])]):e._e(),e.filters("similar")?a("div",{staticClass:"search_item"},[a("h4",[e._v("相似度")]),a("my-slider",{model:{value:e.similarity,callback:function(t){e.similarity=t},expression:"similarity"}})],1):e._e(),e.filters("deviceName")?a("div",{staticClass:"search_item"},[a("h4",[e._v("设备名称")]),a("el-input",{attrs:{size:"small",placeholder:"请输入设备名称"},model:{value:e.deviceName,callback:function(t){e.deviceName=t},expression:"deviceName"}})],1):e._e(),e.filters("ip")?a("div",{staticClass:"search_item"},[a("h4",[e._v("IP地址")]),a("el-input",{attrs:{size:"small",placeholder:"请输入IP地址"},model:{value:e.ip,callback:function(t){e.ip=t},expression:"ip"}})],1):e._e(),e.filters("channel")?a("div",{staticClass:"search_item"},[a("h4",[e._v("channel号")]),a("el-input",{attrs:{size:"small",placeholder:"请输入channel号"},model:{value:e.channel,callback:function(t){e.channel=t},expression:"channel"}})],1):e._e(),a("div",{staticClass:"button_styles"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submit}},[e._v("查询")]),a("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)])},i=[],s=a("b85c"),n=(a("0d03"),a("b0c0"),a("c975"),a("4160"),a("d3b7"),a("159b"),a("87a8")),r=[{id:5002,label:"物品遗留"},{id:5003,label:"物品拿取"},{id:5006,label:"人员徘徊"},{id:5005,label:"人员滞留"}],o=[{id:5001,label:"客流密度"},{id:5004,label:"人员倒地"},{id:5007,label:"人员聚集"},{id:5008,label:"剧烈运动/打斗"},{id:5009,label:"排队时长"},{id:5010,label:"客流量报警"}],c={props:{filtersItem:{type:Array,default:function(){return[]}},areaTree:{type:Array,default:function(){return[]}},camerasData:{type:Array,default:function(){return[]}},type:{type:String},image:{type:String,default:""},time:{default:""}},data:function(){return{startTime:new Date((new Date).toLocaleDateString()),endTime:new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1),datetimerange:[new Date((new Date).toLocaleDateString()),new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)],areaOptions:[],area:[],camera:[],alarmType:"",dealType:"",dealTypeOptions:[{value:1,label:"已处理"},{value:2,label:"未处理"}],alarmLevel:"",alarmLevelOptions:[{value:1,label:"一级"}],alarmTypeOptions:[],similarity:70,deviceName:"",ip:"",channel:""}},watch:{areaTree:{handler:function(e){this.areaOptions=[];var t,a=Object(s["a"])(e);try{for(a.s();!(t=a.n()).done;){var l=t.value,i={label:l.name,value:l.id};if(l.child&&l.child.length>0){i.children=[];var n,r=Object(s["a"])(l.child);try{for(r.s();!(n=r.n()).done;){var o,c=n.value,p=[],h=Object(s["a"])(c.child);try{for(h.s();!(o=h.n()).done;){var u=o.value;p.push({label:u.name,value:u.id})}}catch(d){h.e(d)}finally{h.f()}i.children.push({label:c.name,value:c.id,children:p.length>0?p:void 0})}}catch(d){r.e(d)}finally{r.f()}}this.areaOptions.push(i)}}catch(d){a.e(d)}finally{a.f()}},immediate:!0},time:{handler:function(e){e&&(this.datetimerange=[new Date(new Date(e).toLocaleDateString()),new Date(new Date(new Date(e).toLocaleDateString()).getTime()+864e5-1)],this.startTime=new Date(new Date(e).toLocaleDateString()),this.endTime=new Date(new Date(new Date(e).toLocaleDateString()).getTime()+864e5-1))},immediate:!0}},components:{MySlider:n["a"]},created:function(){"alarmHistory"===this.type?this.alarmTypeOptions=o:this.alarmTypeOptions=r},methods:{filters:function(e){return!!this.filtersItem&&-1!==this.filtersItem.indexOf(e)},submit:function(){var e={},t=[];this.area.length>0&&this.area.forEach((function(e){t.push(e[e.length-1])})),"areaManage"===this.type&&this.area.length>0&&(e={area_ids:t}),"alarmConfig"===this.type&&this.area.length>0&&(e={area_ids:t}),"alarmHistory"===this.type&&(this.area.length>0&&(e.area_ids=t),this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime()),e.type=0,e.camera_ids=this.camera,e.check_status=this.dealType||void 0,e.alarm_source_types=this.alarmType?[this.alarmType]:void 0),"eventSearch"===this.type&&(this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime()),this.area.length>0&&(e.area_ids=t),e.camera_ids=this.camera,e.alarm_source_types=this.alarmType?[this.alarmType]:void 0),"trackDetail"===this.type&&(this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime()),e.score=this.similarity),"takeTrace"===this.type&&(this.area.length>0&&(e.area_ids=t),this.datetimerange[0]&&(e.start_time=this.datetimerange[0].getTime()),this.datetimerange[1]&&(e.end_time=this.datetimerange[1].getTime())),"deviceManage"===this.type&&(e.name=this.deviceName,e.ip=this.ip,e.channel=this.channel),"resourceManage"===this.type&&(this.area.length>0&&(e.area_ids=t),e.name=this.deviceName,e.ip=this.ip,e.channel=this.channel),this.$emit("searchData",e)},reset:function(){this.area=[],this.alarmType="",this.alarmLevel="",this.dealType="",this.camera=[],this.deviceName="",this.channel="",this.ip="",this.datetimerange=[new Date((new Date).toLocaleDateString()),new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)],this.startTime=new Date((new Date).toLocaleDateString()),this.endTime=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)}}},p=c,h=(a("0597"),a("2877")),u=Object(h["a"])(p,l,i,!1,null,"3fd3d4d3",null);t["a"]=u.exports},e370:function(e,t,a){},e8aa:function(e,t,a){}}]);